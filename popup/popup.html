<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Video Speed Controller</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-title">
      <img src="../icons/icon48.png" alt="Logo">
      <h1>Speed Controller</h1>
    </div>
    <div class="header-toggle">
      <label class="toggle-switch">
        <input type="checkbox" id="enabled" checked>
        <span class="toggle-slider"></span>
      </label>
    </div>
  </header>

  <!-- Quick Speed Control -->
  <section class="section speed-control-section">
    <h2 class="section-title">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polygon points="5,3 19,12 5,21"/>
      </svg>
      Quick Speed
    </h2>
    <div class="speed-presets-bar">
      <button class="speed-preset-btn" data-speed="0.5">0.5x</button>
      <button class="speed-preset-btn" data-speed="0.75">0.75x</button>
      <button class="speed-preset-btn" data-speed="1">1x</button>
      <button class="speed-preset-btn" data-speed="1.25">1.25x</button>
      <button class="speed-preset-btn" data-speed="1.5">1.5x</button>
      <button class="speed-preset-btn" data-speed="2">2x</button>
      <button class="speed-preset-btn" data-speed="3">3x</button>
    </div>
    <div class="time-saved-display">
      <span class="time-saved-label">Time Saved</span>
      <span class="time-saved-value" id="time-saved">0m 0s</span>
    </div>
  </section>

  <!-- Behavior Settings Section -->
  <section class="section">
    <h2 class="section-title">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 20V10M18 20V4M6 20v-4"/>
      </svg>
      Behavior
    </h2>
    <div class="settings-list">
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Remember Speed</span>
          <span class="setting-desc">Save speed per website</span>
        </div>
        <label class="toggle-switch">
          <input type="checkbox" id="rememberSpeed">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Force Saved Speed</span>
          <span class="setting-desc">Override player defaults</span>
        </div>
        <label class="toggle-switch">
          <input type="checkbox" id="forceSpeed">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Work on Audio</span>
          <span class="setting-desc">Control audio elements too</span>
        </div>
        <label class="toggle-switch">
          <input type="checkbox" id="workOnAudio">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">PiP Speed Indicator</span>
          <span class="setting-desc">Show floating controller in PiP mode</span>
        </div>
        <label class="toggle-switch">
          <input type="checkbox" id="showPipIndicator" checked>
          <span class="toggle-slider"></span>
        </label>
      </div>
    </div>
  </section>

  <!-- Controller Appearance Section -->
  <section class="section">
    <h2 class="section-title">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"/>
        <path d="M12 1v6m0 6v10M1 12h6m6 0h10"/>
      </svg>
      Appearance
    </h2>
    <div class="settings-list">
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Controller Mode</span>
          <span class="setting-desc">Choose display style</span>
        </div>
        <div class="select-wrapper">
          <select class="select-input" id="controllerMode">
            <option value="minimal">Minimal (Badge)</option>
            <option value="full">Full (Panel)</option>
          </select>
        </div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Opacity</span>
          <span class="setting-desc">Controller transparency</span>
        </div>
        <div class="range-container">
          <input type="range" class="range-slider" id="opacity" min="0.1" max="1" step="0.1" value="0.8">
          <span class="range-value" id="opacity-value">80%</span>
        </div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Hide by Default</span>
          <span class="setting-desc">Press shortcut to show</span>
        </div>
        <label class="toggle-switch">
          <input type="checkbox" id="hideByDefault">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Auto-Hide Timer</span>
          <span class="setting-desc">Fade after inactivity (0 = off)</span>
        </div>
        <div class="range-container">
          <input type="range" class="range-slider" id="autoHideDelay" min="0" max="10" step="1" value="0">
          <span class="range-value" id="autoHideDelay-value">Off</span>
        </div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Badge Colors</span>
          <span class="setting-desc">Customize overlay colors</span>
        </div>
        <div class="color-pickers">
          <div class="color-picker-item">
            <label for="colorBackground">BG</label>
            <input type="color" id="colorBackground" value="#1a1a2e">
          </div>
          <div class="color-picker-item">
            <label for="colorAccent">Text</label>
            <input type="color" id="colorAccent" value="#e94560">
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Shortcuts Section -->
  <section class="section">
    <h2 class="section-title">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="2" y="4" width="20" height="16" rx="2"/>
        <path d="M6 8h.01M10 8h.01M14 8h.01M18 8h.01M8 12h8M6 16h.01M18 16h.01"/>
      </svg>
      Keyboard Shortcuts
    </h2>
    <div class="shortcuts-list" id="shortcuts-list">
      <!-- Shortcuts will be rendered by JS -->
    </div>
  </section>

  <!-- Intro/Outro Skip Section -->
  <section class="section">
    <h2 class="section-title">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polygon points="5,4 15,12 5,20"/>
        <line x1="19" y1="5" x2="19" y2="19"/>
      </svg>
      Intro/Outro Skip
    </h2>
    <p class="section-desc">Automatically skip intros and outros, or use hotkeys to skip manually</p>
    <div class="settings-list">
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Enable Intro/Outro Skip</span>
          <span class="setting-desc">Auto-skip or use hotkeys</span>
        </div>
        <label class="toggle-switch">
          <input type="checkbox" id="introOutroEnabled">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Default Intro Skip</span>
          <span class="setting-desc">Seconds to skip at start</span>
        </div>
        <div class="number-input-wrapper">
          <input type="number" class="number-input" id="defaultIntroSkip" min="0" max="300" step="1" value="0">
          <span class="number-unit">s</span>
        </div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Default Outro Skip</span>
          <span class="setting-desc">Seconds before end to skip</span>
        </div>
        <div class="number-input-wrapper">
          <input type="number" class="number-input" id="defaultOutroSkip" min="0" max="300" step="1" value="0">
          <span class="number-unit">s</span>
        </div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Auto-Skip on Play</span>
          <span class="setting-desc">Skip intro automatically when video starts</span>
        </div>
        <label class="toggle-switch">
          <input type="checkbox" id="autoSkipIntro">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Skip Intro Hotkey</span>
          <span class="setting-desc">Press to skip intro manually</span>
        </div>
        <div class="shortcut-key">
          <input type="text" class="key-input intro-outro-key" id="skipIntroKey" value="I" readonly>
        </div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span class="setting-name">Skip Outro Hotkey</span>
          <span class="setting-desc">Press to skip to end/next</span>
        </div>
        <div class="shortcut-key">
          <input type="text" class="key-input intro-outro-key" id="skipOutroKey" value="O" readonly>
        </div>
      </div>
    </div>
    <div class="intro-outro-site-rules">
      <h3 class="subsection-title">Per-Site Rules</h3>
      <p class="section-desc">Override intro/outro times for specific sites</p>
      <div class="intro-outro-rule-input-row">
        <input type="text" class="intro-outro-site-input" id="intro-outro-site" placeholder="Site (e.g., youtube.com)">
        <input type="number" class="intro-outro-time-input" id="intro-outro-intro" placeholder="Intro" min="0" max="300" step="1">
        <input type="number" class="intro-outro-time-input" id="intro-outro-outro" placeholder="Outro" min="0" max="300" step="1">
        <button class="intro-outro-rule-add" id="intro-outro-rule-add">Add</button>
      </div>
      <div class="intro-outro-rules-list" id="intro-outro-rules-list">
        <!-- Per-site rules rendered by JS -->
      </div>
    </div>
  </section>

  <!-- URL Rules Section -->
  <section class="section">
    <h2 class="section-title">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
      </svg>
      URL Speed Rules
    </h2>
    <p class="section-desc">Set default speeds for specific URL patterns (e.g., "/shorts" = 1x)</p>
    <div class="url-rules-container">
      <div class="url-rule-input-row">
        <input type="text" class="url-rule-pattern" id="url-rule-pattern" placeholder="URL pattern (e.g., /shorts)">
        <input type="number" class="url-rule-speed" id="url-rule-speed" placeholder="Speed" min="0.1" max="16" step="0.1" value="1">
        <button class="url-rule-add" id="url-rule-add">Add</button>
      </div>
      <div class="url-rules-list" id="url-rules-list">
        <!-- URL rules rendered by JS -->
      </div>
    </div>
  </section>

  <!-- Blacklist Section -->
  <section class="section">
    <h2 class="section-title">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/>
      </svg>
      Site Blacklist
    </h2>
    <div class="blacklist-container">
      <div class="blacklist-input-row">
        <input type="text" class="blacklist-input" id="blacklist-input" placeholder="Enter domain or regex pattern">
        <button class="blacklist-add" id="blacklist-add">Add</button>
      </div>
      <div class="blacklist-list" id="blacklist-list">
        <!-- Blacklist items rendered by JS -->
      </div>
    </div>
  </section>

  <!-- Sync Status -->
  <section class="section sync-section">
    <div class="sync-status" id="sync-status">
      <svg class="sync-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 12c0 1.2-4 6-9 6s-9-4.8-9-6c0-1.2 4-6 9-6s9 4.8 9 6z"/>
        <circle cx="12" cy="12" r="3"/>
      </svg>
      <div class="sync-info">
        <span class="sync-label">Cloud Sync</span>
        <span class="sync-time" id="sync-time">Checking...</span>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <button class="btn" id="btn-export">Export</button>
    <button class="btn" id="btn-import">Import</button>
    <button class="btn btn-danger" id="btn-reset">Reset</button>
  </footer>

  <!-- Hidden file input for import -->
  <input type="file" class="hidden-input" id="import-input" accept=".json">

  <!-- Notification -->
  <div class="notification" id="notification"></div>

  <script src="../browser-polyfill.min.js"></script>
  <script src="popup.js"></script>
</body>
</html>
